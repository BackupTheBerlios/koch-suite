#!<%%PHP%%> <%%PHP_OPTS%%>
<?
  /* 
   * $Id: mmexport.raw,v 1.7 2001/02/21 11:37:01 michael Exp $
   * print a recipe in Meal-Master-format to STDOUT
   * (c) Michael Lestinsky <michael@zaphod.rhein-neckar.de>, November 200
   *
   * See the bundled file "LICENCE" for the Licence of this software. 
   */

  require "<%%PHP_LIBS%%>/functions.inc";

  $stdout = fopen("php://stdout", "w");
  $stderr = fopen("php://stderr", "w");

  $ver = "0.2.6";
  $tool = "mmexport";
  $helptext  = "$tool $ver\n" ;
  $helptext .= "Invoke as:\n";
  $helptext .= "\t$tool \"searchstring\"\n";

  if ($argc == 1) {
    /* No search-string */

    fputs ($stderr, $helptext);
  } else {

    $name = "%" . $argv[1] . "%";

    foreach (get_mid_by_name($name) as $menu) {
      fputs($stdout, mmexport(get_menu_by_mid($menu["id"])));
    }
  }

  fclose ($stdout);
  fclose ($stderr);

?>

