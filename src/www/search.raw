<?
  require "<%%PHP_LIBS%%>/config.inc";
  require "<%%PHP_LIBS%%>/functions.inc";
  require "<%%PHP_LIBS%%>/lang.inc";
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>

<head>
  <link rel="stylesheet" type="text/css" href="styles.css">
  <link rev="made" href="mailto:michael@zaphod.rhein-neckar.de">
  <meta http-equiv="Content-Script-Type" content="text/javascript">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title>Koch-Suite</title>
  <!-- $Id: search.raw,v 1.4 2001/06/20 18:33:29 michael Exp $ -->
</head>

<body>
<a name="top"></a>
<h1><img src="pics/title.gif" alt="Koch-Suite"></h1>

<table border=0 cellpadding=3 cellspacing=1>
<tr>
  <td valign="top">
    <? include "./menue.inc"; ?>
  </td>
  <td>

    <?
      if (isset($HTTP_POST_VARS["begriff"])) $begriff = $HTTP_POST_VARS["begriff"];
      if (isset($HTTP_POST_VARS["where"]))   $where   = $HTTP_POST_VARS["where"];
      if (isset($HTTP_GET_VARS["all"]))      $all     = $HTTP_GET_VARS["all"];

      if (empty($begriff) and empty($all)) {
        /* No search -> make search-form */
        ?>
        <h2><? echo $Lang['Search']['Search']; ?></h2>
        <script language="JavaScript1.2">
          <!--
            function kat() {
              foo = "kategorien.php?target=begriff&maxsel=1";
              window.open(foo, 'kat', 'width=300,height=400,screenX=700,screenY=300,scrollbars=yes');
              document.forms[0].where.options[1].selected = true;
            }
          //-->
        </script>
        
        <form action="<? echo $PHP_SELF; ?>" method="post">
          <table border=0>
            <tr>
              <td><? echo $Lang['Search']['For']; ?></td>
              <td><input type="text" name="begriff" value="<? echo $begr ?>">
            </tr>
            <tr>
              <td><? echo $Lang['Search']['In']; ?></td>
              <td><select name="where">
                    <option value="title"><? echo $Lang['Search']['Menutitle']; ?></option>
                    <option value="cat" <? if ($begr != '') echo 'selected' ?>><? echo $Lang['Search']['Categories']; ?></option>
                    <option value="ingred"><? echo $Lang['Search']['Ingredients']; ?></option>
                  </select>
              </td>
            </tr>
          </table>
        <input type="submit" value="<? echo $Lang['Search']['Go']; ?>">
        <input type="reset" value="<? echo $Lang['Delete']; ?>">
        </form>
        <p>
          [<a href="<? echo "$PHP_SELF?all=1"; ?>"><? echo $Lang['AllRecipes']; ?></a>]
          [<a href="kategorien.php?target=begriff&maxsel=1" target="kat" onClick="kat();"><? echo $Lang['CatChoose']; ?></a>]
          <br>
          <a class="prop" href="<? echo "$PHP_SELF?all=a"; ?>">A</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=b"; ?>">B</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=c"; ?>">C</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=d"; ?>">D</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=e"; ?>">E</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=f"; ?>">F</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=g"; ?>">G</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=h"; ?>">H</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=i"; ?>">I</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=j"; ?>">J</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=k"; ?>">K</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=l"; ?>">L</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=m"; ?>">M</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=n"; ?>">N</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=o"; ?>">O</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=p"; ?>">P</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=q"; ?>">Q</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=r"; ?>">R</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=s"; ?>">S</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=t"; ?>">T</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=u"; ?>">U</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=v"; ?>">V</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=w"; ?>">W</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=x"; ?>">X</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=y"; ?>">Y</a>
          <a class="prop" href="<? echo "$PHP_SELF?all=z"; ?>">Z</a>
        </p>
    
    <?
      } else {
        /* We have something to do, let's go: */
    ?>
        <h2><? echo $Lang['Search']['Result']; ?>:
          <? 
             if (empty($all)) { 
               echo $begriff;
             } 
          ?> 
        </h2>
    
        <table border=0>
    <?
    
        function print_titles($r) {
          $count = 0;
          foreach ($r as $foo) {
            $count++;
            echo "<tr><td>$count</td>" .
                     "<td><a href=\"rezept.php?mid=" . $foo["id"] . "\">" . 
                     htmlentities($foo["title"]) . "</a></td></tr>\n";
          }
        }

        /* Do the search */
        if (empty($where)) $where = 'title';
        if ($m = exec_search($begriff, $where, $all)) {
          print_titles($m);
        } else {
          echo "<tr><td>" . $Lang['Search']['NoResult']. "</td></tr>\n";
        }
      ?>
        </table>
      <?
      }
    ?>
  </td>
</tr>
</table>

<hr noshade>
&copy; 2001 Michael Lestinsky 
&lt;<a href="mailto:michael@zaphod.rhein-neckar.de">michael@zaphod.rhein-neckar.de</a>&gt;.
</body>
</html>
<?db_disconnect();?>
