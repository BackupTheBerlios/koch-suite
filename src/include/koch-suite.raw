<?
  /*
   * $Id: koch-suite.raw,v 1.8 2002/04/09 14:36:03 lestinsky Exp $
   * Configuration-file for the Koch-Suite
   *
   * (c) by Michael Lestinsky <michael@zaphod.rhein-neckar.de>, May 2001
   * See LICENSE in the top-level directory of the Koch-Suite distribution
   * for the License of this file.
   */

  require_once '<%%PHP_LIBS%%>/defines.inc';

  /* ==================================
   * Section I: Configure PHP as needed
   * ================================== */

  /* Use PEAR from this directory: */
  $PEAR = '<%%PEAR%%>';


  /* ================================
   * Section II: Setup the Koch-Suite
   * ================================ */

  // Shall we be in debug-mode? Answer "yes" or "no".
  // If yes: all SQL-Queries and a little more will be logged in
  // /tmp/koch-suite-debug. This will include passwords...

  $DEBUG = "yes";                             // Mind security, disable this.
  error_reporting(E_ALL);


  /* Paths: */

  $PDFLATEX = "<%%pdflatex%%>";
  $LATEX    = "<%%latex%%>";
  $DVIPS    = "<%%dvips%%>";
  $GS       = "<%%gs%%>";
  $TMPDIR   = "/tmp";


  /* Authentication: */

  // What to authenticate the user against? 
  // At the moment "auth_by_db" is the only supported mechanism. 
  // But this might be extendet to LDAP, file,... easily.
  $AUTH_STYLE = "auth_by_db";

  // What level of authentication do we want? ALL, READ, WRITE or NONE?
  // Operations of this level or a higher level will require 
  // user authentication.
  $AUTH_LEVEL = READ;  // Capitals and no quotes, these are constants!


  /*
   * Offer "printable" recipes in that format: 
   * May be: "html", "latex", "ps", "pdf" 
   * We will fall back in this queue from right to left if one of the 
   * required tools is missing.
   */
  $PRINTABLE_FORMAT = "pdf";


  /*
   * What about the Database?
   */

  /* DSN */
  $DB_DSN      = array('phptype'  => "<%%DB_TYPE%%>",
                       'dbsyntax' => false,
                       'protocol' => false,
                       'hostspec' => "<%%DB_SERVER%%>",
                       'database' => "<%%DB_NAME%%>",
                       'username' => "<%%DB_USER%%>",
                       'password' => "<%%DB_PASSWORD%%>" );

  /* ==================================================
   * Section III: You don't need to care about the rest
   * ================================================== */

  /* The name of the Session-Cookie */
  session_name("KS_SESS");

  /* Extend the include-path to $PEAR, or PEAR-Modules won't work 
   * correctly. */
  $path = ini_get("include_path");
  if (! ini_set("include_path", "$PEAR:$path"))
    die ("Can't setup include-path correctly.\n");

  if (! set_magic_quotes_runtime(0))
    die ("Can't disable magic_quotes_runtime.\n");

  /* Load additional files: */
  require_once '<%%PEAR%%>/DB.php';
  require_once '<%%PHP_LIBS%%>/debug.inc';

  $DB_STYLE    = $DB_DSN["phptype"];

  /* Do the Database-connect */
  write_log("Connecting to " . serialize($DB_DSN));
  $db=DB::connect($DB_DSN);

  if (DB::isError($db)) {
    write_log("Can't connect to database ". $DB_DSN['database'] ."': ". 
              $db->getMessage());
    die("Can't connect to database '" . $DB_DSN['database'] ."': " . 
        $db->getMessage());
  }


  /* Return associative arrays per default */
  $db->setFetchMode(DB_FETCHMODE_ASSOC);
?>
