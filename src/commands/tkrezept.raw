#!<%%PERL%%> <%%PERL_OPTS%%>
# $Id: tkrezept.raw,v 1.2 2001/01/07 20:18:25 michael Exp $
#
# This file may be used under the terms of the license as included in
# the file 'LICENSE' in the top-level distribution directory.

# use strict;
use Tk;

my $filename;
my @rezept;
my $VER = "0.1";
my $foo = 	"	Menge	Einheit	Zutat";

# Fenster-Definitionen
my $mw = MainWindow->new;
my $oben  = $mw->Frame(-relief => "groove", -borderwidth => "2")
  ->pack(-side => "top",
         -fill => "both",
         -padx => "5",
         -pady => "2");
my $unten = $mw->Frame(-relief => "groove", -borderwidth => "2")
  ->pack(-side => "bottom",
         -fill => "both",
         -padx => "5",
         -pady => "2");

# Fenster
$mw->title ("tkrezept");

# Oberes Frame: Lese den Dateinamen ein, Beenden-Button.
$oben->Button(-text => "Beenden", -command => \&ende)
  ->pack(-side => "right");
$oben->Button(-text => "Speichern", -command => \&speichern)
  ->pack(-side => "right");
$oben->Label(-text => "Dateiname:")
  ->pack(-side => "left");
my $filename_t = $oben->Entry(-width => "20")
  ->pack(-side => "left");

# Unteres Frame:
my $globaldef = $unten->Frame()->pack(-side => "top", -fill => "x");
my $title_f = $globaldef->Frame()->pack(-side => "top", -fill => "x");
my $cat_f = $globaldef->Frame()->pack(-side => "top", -fill => "x");
my $yield_f = $globaldef->Frame()->pack(-side => "top", -fill => "x");

$title_f->Label(-text => "Rezept-Titel:")->pack(-side=> "left");
my $title_t = $title_f->Entry(-width => "50")->pack(-side => "right");

$cat_f->Label(-text => "Kategorien:")->pack(-side => "left");
my $cat_t = $cat_f->Entry(-width => "50")->pack(-side => "right");

$yield_f->Label(-text => "Portionen:")->pack(-side => "left");
my $yield_t = $yield_f->Entry(-width => "50")->pack(-side => "right");

my $zutaten_f = $unten->Frame()->pack(-side => "top", -fill => "x");
$zutaten_f->Label(-text => "Zutaten:")->pack(-anchor => "nw");
my $zutaten_t = $zutaten_f->Scrolled("Text", -scrollbars=>"oe",
                                             -width=>"80", 
                                             -height=>"10",
                                             -tabs=>[qw/2c right 2.4c 4.8c left/])
                  ->pack(-anchor=>"w");

$zutaten_t->insert("1.0", $foo."\n");

my $anweisung_f = $unten->Frame()->pack(-side => "bottom", -fill => "x");
$anweisung_f->Label(-text => "Anweisungen:")->pack(-anchor => "nw");
my $anweisung_t = $anweisung_f->Scrolled("Text", -scrollbars=> "oe", 
                                                 -width=>"80", 
                                                 -height => "10")
                    ->pack(-anchor => "w");

MainLoop;

sub ende {
  # Beende das Programm
  exit
}

sub speichern {
  # Speichere das Rezept in die angegebene Datei
  $filename = $filename_t->get();
  $str  = "MMMMM----------tkrezept (" . $VER . ") nach Meal-Master-----"."\n";
  $str .= "     Title: " . $title_t->get() . "\n";
  $str .= "Categories: " . $cat_t->get() . "\n";
  $str .= "     Yield: " . $yield_t->get() . "\n\n";
  $str .= $zutaten_t->get("2.0", "end") . "\n";
  $str .= $anweisung_t->get("1.0", "end");
  $str .= "\nMMMMM\n";

  #printf $filename . "\n";
  printf $str . "\n";
}

sub importieren {
  # Uebergebe das Rezept an die Datenbank.
}
